var bookmarklet = document.getElementById('bookmarklet');
bookmarklet.href=
"javascript:(function()%7B%22use%20strict%22%3B%0A%0A%2F%2F%20check%20if%20this%20website%20is%20a%20google%20slides%20page%0Afunction%20isGoogleSlidesPresentation()%20%7B%0A%20%20return%20window.location.host%20%3D%3D%3D%20%22docs.google.com%22%20%26%26%20window.location.pathname.startsWith(%22%2Fpresentation%22)%20%26%26%20getPresentationButton()%3B%0A%7D%0A%0Avar%20slideTitlePrefix%20%3D%20'%E2%96%B9'%3B%0Avar%20slideTitleRegex%20%3D%20%2F%E2%96%B9(%5Cd%2B)%24%2F%3B%0A%0Afunction%20setSlideTitle(slideNum)%20%7B%0A%20%20var%20title%20%3D%20window.document.querySelector('.docs-title-input')%3B%0A%20%20var%20currentTitle%20%3D%20title.value%3B%0A%20%20var%20nextTitle%20%3D%20currentTitle.match(slideTitleRegex)%20%3F%20currentTitle.replace(slideTitleRegex%2C%20function%20(j%2C%20a)%20%7B%0A%20%20%20%20return%20slideTitlePrefix%20%2B%20slideNum%3B%0A%20%20%7D)%20%3A%20currentTitle%20%2B%20slideTitlePrefix%20%2B%20slideNum%3B%0A%20%20title.value%20%3D%20nextTitle%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22focus%22)%3B%0A%20%20%7D%2C%200)%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22blur%22)%3B%0A%20%20%7D%2C%201)%3B%0A%7D%0A%0Afunction%20cleanupSlideTitle()%20%7B%0A%20%20var%20title%20%3D%20window.document.querySelector('.docs-title-input')%3B%0A%20%20title.value%20%3D%20title.value.replace(slideTitleRegex%2C%20'')%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22focus%22)%3B%0A%20%20%7D%2C%200)%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22blur%22)%3B%0A%20%20%7D%2C%201)%3B%0A%7D%0A%0Afunction%20incrementTitle()%20%7B%0A%20%20var%20title%20%3D%20document.querySelector('.docs-title-input')%3B%0A%20%20var%20currentTitle%20%3D%20title.value%3B%0A%20%20var%20nextTitle%20%3D%20currentTitle.match(slideTitleRegex)%20%3F%20currentTitle.replace(slideTitleRegex%2C%20function%20(j%2C%20a)%20%7B%0A%20%20%20%20return%20slideTitlePrefix%20%2B%20(parseInt(a)%20%2B%201)%3B%0A%20%20%7D)%20%3A%20currentTitle%20%2B%20slideTitlePrefix%20%2B%20%221%22%3B%0A%20%20title.value%20%3D%20nextTitle%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22focus%22)%3B%0A%20%20%7D%2C%200)%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(title%2C%20%22blur%22)%3B%0A%20%20%7D%2C%201)%3B%0A%7D%0A%0Afunction%20getSlideNumberFromTitle()%20%7B%0A%20%20var%20title%20%3D%20window.document.querySelector('.docs-title-input')%3B%0A%20%20var%20match%20%3D%20title.value.match(slideTitleRegex)%3B%0A%0A%20%20if%20(match)%20%7B%0A%20%20%20%20return%20match%5B1%5D%3B%0A%20%20%7D%0A%0A%20%20return%20undefined%3B%0A%7D%0A%0Afunction%20eventFire(el%2C%20etype)%20%7B%0A%20%20if%20(el.fireEvent)%20%7B%0A%20%20%20%20el.fireEvent('on'%20%2B%20etype)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20evObj%20%3D%20window.document.createEvent('Events')%3B%0A%20%20%20%20evObj.initEvent(etype%2C%20true%2C%20false)%3B%0A%20%20%20%20el.dispatchEvent(evObj)%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20mouseEventFire(el%2C%20etype%2C%20x%2C%20y)%20%7B%0A%20%20if%20(!x%20%7C%7C%20!y)%20%7B%0A%20%20%20%20var%20bounds%20%3D%20el.getBoundingClientRect()%3B%0A%20%20%20%20x%20%3D%20bounds.left%20%2B%20bounds.width%20%2F%202%3B%0A%20%20%20%20y%20%3D%20bounds.top%20%2B%20bounds.height%20%2F%202%3B%0A%20%20%7D%20%2F%2Fvar%20ev%20%3D%20window.document.createEvent(%22MouseEvent%22)%3B%0A%20%20%2F%2Fev.initMouseEvent(%0A%20%20%2F%2F%20%20%20%20etype%2C%0A%20%20%2F%2F%20%20%20%20true%20%2F*%20bubble%20*%2F%2C%20true%20%2F*%20cancelable%20*%2F%2C%0A%20%20%2F%2F%20%20%20%20window%2C%20null%2C%0A%20%20%2F%2F%20%20%20%20x%2C%20y%2C%200%2C%200%2C%20%2F*%20coordinates%20*%2F%0A%20%20%2F%2F%20%20%20%20false%2C%20false%2C%20false%2C%20false%2C%20%2F*%20modifier%20keys%20*%2F%0A%20%20%2F%2F%20%20%20%200%20%2F*left*%2F%2C%20null%0A%20%20%2F%2F)%3B%0A%0A%0A%20%20var%20ev%20%3D%20new%20MouseEvent(etype%2C%20%7B%0A%20%20%20%20'view'%3A%20window%2C%0A%20%20%20%20'bubbles'%3A%20true%2C%0A%20%20%20%20'cancelable'%3A%20true%2C%0A%20%20%20%20'screenX'%3A%20x%2C%0A%20%20%20%20'screenY'%3A%20y%0A%20%20%7D)%3B%0A%20%20el.dispatchEvent(ev)%3B%0A%7D%0A%0Afunction%20click(el)%20%7B%0A%20%20if%20(!el)%20%7B%0A%20%20%20%20console.log('cannot%20click%20on%20undefined')%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20eventFire(el%2C%20'mousedown')%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(el%2C%20'mouseup')%3B%0A%20%20%7D%2C%200)%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20eventFire(el%2C%20'mouseout')%3B%0A%20%20%7D%2C%201)%3B%0A%7D%0A%0Afunction%20getPresentationIframe()%20%7B%0A%20%20return%20window.document.getElementsByClassName(%22punch-present-iframe%22)%5B0%5D%3B%0A%7D%0A%0Afunction%20getPresentation()%20%7B%0A%20%20var%20presentationIframe%20%3D%20getPresentationIframe()%3B%0A%20%20return%20presentationIframe%20%3F%20presentationIframe.contentWindow.document%20%3A%20undefined%3B%0A%7D%0A%0Afunction%20getSlideMenuButton()%20%7B%0A%20%20var%20_getPresentation%3B%0A%0A%20%20return%20(_getPresentation%20%3D%20getPresentation())%20%3D%3D%3D%20null%20%7C%7C%20_getPresentation%20%3D%3D%3D%20void%200%20%3F%20void%200%20%3A%20_getPresentation.querySelector('div%5Bclass*%3D%22goog-inline-block%20goog-flat-menu-button%22%5D')%3B%0A%7D%0A%0Afunction%20hasEditAccess()%20%7B%0A%20%20return%20!window.document.querySelector('%23docs-access-level-indicator')%3B%0A%7D%0A%0Afunction%20getPresentationButton()%20%7B%0A%20%20return%20window.document.getElementById('punch-start-presentation-left')%3B%0A%7D%0A%0Afunction%20startPresentationMode()%20%7B%0A%20%20if%20(getPresentation())%20return%3B%20%2F%2F%20already%20in%20presentation%20mode%0A%0A%20%20var%20presentationButton%20%3D%20getPresentationButton()%3B%0A%20%20mouseEventFire(presentationButton%2C%20'mousedown')%3B%0A%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20mouseEventFire(presentationButton%2C%20'mouseup')%3B%0A%20%20%7D%2C%200)%3B%0A%7D%0A%0Afunction%20goToSlide(slideNum)%20%7B%0A%20%20var%20presentation%20%3D%20getPresentation()%3B%0A%20%20var%20slideMenu%20%3D%20presentation.querySelector('div%5Bclass%3D%22goog-menu%20goog-menu-vertical%22%5D%5Brole%3D%22listbox%22%5D')%3B%0A%0A%20%20if%20(!slideMenu)%20%7B%0A%20%20%20%20if%20(!getSlideMenuButton())%20%7B%0A%20%20%20%20%20%20console.log('Waiting%20for%20slide%20menu%20button%20to%20appear')%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20console.log('Opening%20the%20slide%20menu!')%3B%0A%20%20%20%20mouseEventFire(getSlideMenuButton()%2C%20'mousedown')%3B%0A%20%20%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20return%20mouseEventFire(getSlideMenuButton()%2C%20'mouseup')%3B%0A%20%20%20%20%7D%2C%200)%3B%0A%20%20%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20return%20mouseEventFire(getSlideMenuButton()%2C%20'mousedown')%3B%0A%20%20%20%20%7D%2C%201)%3B%0A%20%20%20%20return%3B%0A%20%20%7D%20%2F%2F%20index%20starts%20at%201%0A%0A%0A%20%20slideNum%20%3D%20clamp(slideNum%2C%201%2C%20slideMenu.children.length)%3B%0A%20%20var%20child%20%3D%20slideMenu.children%5BslideNum%20-%201%5D%3B%0A%20%20click(child)%3B%0A%7D%0A%0Afunction%20clamp(value%2C%20min%2C%20max)%20%7B%0A%20%20return%20Math.min(Math.max(value%2C%20min)%2C%20max)%3B%0A%7D%0A%0A%3B%0A%0Afunction%20getSlideNumberFromPresentationMenu()%20%7B%0A%20%20var%20_getSlideMenuButton%3B%0A%0A%20%20var%20slideMenuText%20%3D%20(_getSlideMenuButton%20%3D%20getSlideMenuButton())%20%3D%3D%3D%20null%20%7C%7C%20_getSlideMenuButton%20%3D%3D%3D%20void%200%20%3F%20void%200%20%3A%20_getSlideMenuButton.innerText%3B%0A%20%20return%20slideMenuText%20%3F%20slideMenuText.match(%2F(%5Cd%2B)%2F)%5B1%5D%20%3A%20undefined%3B%0A%7D%0A%0Afunction%20addTemporaryKey(obj%2C%20key%2C%20lifetimeMs)%20%7B%0A%20%20if%20(obj.hasOwnProperty(key))%20%7B%0A%20%20%20%20clearTimeout(obj%5Bkey%5D)%3B%0A%20%20%7D%0A%0A%20%20obj%5Bkey%5D%20%3D%20setTimeout(function%20()%20%7B%0A%20%20%20%20return%20delete%20obj%5Bkey%5D%3B%0A%20%20%7D%2C%20lifetimeMs)%3B%0A%7D%20%2F%2F%20Main%20functions%20%3D%3D%3D%3D%3D%0A%0A%0Afunction%20startPresent()%20%7B%0A%20%20if%20(isPresenting())%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20window.slideSyncPresentRecentSlides%20%3D%20%7B%7D%3B%0A%0A%20%20var%20pollLocalSlideNumber%20%3D%20function%20pollLocalSlideNumber()%20%7B%0A%20%20%20%20if%20(getPresentation())%20%7B%0A%20%20%20%20%20%20var%20slideNumber%20%3D%20getSlideNumberFromPresentationMenu()%3B%0A%0A%20%20%20%20%20%20if%20(slideNumber)%20%7B%0A%20%20%20%20%20%20%20%20var%20titleNumber%20%3D%20getSlideNumberFromTitle()%3B%20%2F%2F%20local%20change%0A%0A%20%20%20%20%20%20%20%20if%20(!titleNumber%20%7C%7C%20window.slideSyncPresentCurrentLocalSlide%20!%3D%20slideNumber)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(slideNumber%20!%3D%20titleNumber)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setSlideTitle(slideNumber)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20%2F%2F%20remote%20change%0A%20%20%20%20%20%20%20%20%2F%2F%20when%20flipping%20through%20slides%20the%20title%20updates%20with%20a%20delay.%20Ignore%20expected%20title%20changes%0A%20%20%20%20%20%20%20%20%2F%2F%20however%2C%20if%20the%20title%20doesn't%20get%20to%20the%20current%20slide%20soon%20enough%2C%20switch%20to%20that%20slide%0A%20%20%20%20%20%20%20%20%2F%2F%20this%20can%20occur%20if%20there%20are%20multiple%20hosts%20changing%20the%20slide%20at%20the%20same%20time.%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(slideNumber%20!%3D%20titleNumber%20%26%26%20!window.slideSyncPresentRecentSlides%5BtitleNumber%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20goToSlide(titleNumber)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20addTemporaryKey(window.slideSyncPresentRecentSlides%2C%20slideNumber%2C%202000)%3B%0A%20%20%20%20%20%20%20%20window.slideSyncPresentCurrentLocalSlide%20%3D%20slideNumber%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.log(%22couldn't%20find%20slide%20menu%22)%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20setStatus()%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%2F%2FsetStatus('Sync%20Paused')%3B%0A%20%20%20%20%20%20console.log('go%20to%20Present')%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20window.slideSyncPresentInterval%20%3D%20setInterval(pollLocalSlideNumber%2C%20100)%3B%0A%20%20pollLocalSlideNumber()%3B%0A%7D%0A%0Afunction%20stopPresent()%20%7B%0A%20%20if%20(window.slideSyncPresentInterval)%20%7B%0A%20%20%20%20clearInterval(window.slideSyncPresentInterval)%3B%0A%20%20%20%20window.slideSyncPresentInterval%20%3D%20null%3B%0A%20%20%20%20window.slideSyncPresentRecentSlides%20%3D%20null%3B%0A%20%20%20%20cleanupSlideTitle()%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20startView()%20%7B%0A%20%20if%20(isViewing())%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%0A%20%20var%20pollSlideNumber%20%3D%20function%20pollSlideNumber()%20%7B%0A%20%20%20%20var%20slideNumber%20%3D%20getSlideNumberFromTitle()%3B%0A%0A%20%20%20%20if%20(!slideNumber)%20%7B%0A%20%20%20%20%20%20setStatus('Waiting%20for%20host...')%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(getPresentation())%20%7B%0A%20%20%20%20%20%20var%20currentSlideNumber%20%3D%20getSlideNumberFromPresentationMenu()%3B%0A%20%20%20%20%20%20if%20(currentSlideNumber%20%26%26%20currentSlideNumber%20!%3D%20slideNumber)%20goToSlide(slideNumber)%3B%0A%20%20%20%20%20%20setStatus()%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%2F%2FsetStatus('Sync%20Paused')%3B%0A%20%20%20%20%20%20console.log('go%20to%20Present')%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20window.slideSyncViewInterval%20%3D%20setInterval(pollSlideNumber%2C%20100)%3B%0A%20%20pollSlideNumber()%3B%0A%7D%0A%0Afunction%20stopView()%20%7B%0A%20%20if%20(window.slideSyncViewInterval)%20%7B%0A%20%20%20%20clearInterval(window.slideSyncViewInterval)%3B%0A%20%20%20%20window.slideSyncViewInterval%20%3D%20null%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20isPresenting()%20%7B%0A%20%20return%20!!window.slideSyncPresentInterval%3B%0A%7D%0A%0Afunction%20isViewing()%20%7B%0A%20%20return%20!!window.slideSyncViewInterval%3B%0A%7D%20%2F%2F%20clear%20all%20intervals%20when%20rerunning%20the%20script%0A%0A%0AstopPresent()%3B%0AstopView()%3B%20%2F%2F%20UI%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%0Afunction%20removeExistingUI()%20%7B%0A%20%20var%20existingContainer%20%3D%20getUI()%3B%0A%0A%20%20if%20(existingContainer)%20%7B%0A%20%20%20%20existingContainer.parentNode.removeChild(existingContainer)%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20getUI()%20%7B%0A%20%20var%20uiInDefaultView%20%3D%20window.document.getElementById('slide-sync-base')%3B%0A%20%20if%20(uiInDefaultView)%20return%20uiInDefaultView%3B%0A%20%20var%20uiInPresentation%20%3D%20getUIInPresentation()%3B%0A%20%20if%20(uiInPresentation)%20return%20uiInPresentation%3B%0A%20%20return%20null%3B%0A%7D%0A%0Afunction%20getUIInPresentation()%20%7B%0A%20%20var%20_getPresentation2%3B%0A%0A%20%20return%20(_getPresentation2%20%3D%20getPresentation())%20%3D%3D%3D%20null%20%7C%7C%20_getPresentation2%20%3D%3D%3D%20void%200%20%3F%20void%200%20%3A%20_getPresentation2.getElementById('slide-sync-base')%3B%0A%7D%0A%0Afunction%20addScopedStyle(parent%2C%20styleString)%20%7B%0A%20%20var%20style%20%3D%20document.createElement('style')%3B%0A%20%20style.scoped%20%3D%20true%3B%0A%20%20parent.appendChild(style)%3B%0A%20%20style.textContent%20%3D%20styleString%3B%0A%7D%0A%0Afunction%20ensureCss(context)%20%7B%0A%20%20addScopedStyle(context%2C%20%22%5Cn%20%20%20%20%23slide-sync-container%20%7B%5Cn%20%20%20%20%20%20position%3Afixed%3B%5Cn%20%20%20%20%20%20top%3A%200%3B%5Cn%20%20%20%20%20%20left%3A%200%3B%5Cn%20%20%20%20%20%20right%3A%200%3B%5Cn%20%20%20%20%20%20display%3Aflex%3B%5Cn%20%20%20%20%20%20justify-content%3Acenter%3B%5Cn%20%20%20%20%20%20pointer-events%3A%20none%3B%5Cn%20%20%20%20%20%20z-index%3A%20999%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%5Cn%20%20%20%20%40keyframes%20fadeInFromNone%20%7B%5Cn%20%20%20%20%20%20%20%2010%25%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20translateY(0px)%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%201%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%2050%25%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20translateY(0px)%3B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%201%3B%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%23slide-sync-bar-anim%20%7B%5Cn%20%20%20%20%20%20pointer-events%3A%20all%3B%5Cn%5Cn%20%20%20%20%20%20transition%3A%20opacity%201s%200.5s%2C%20transform%201s%200.5s%3B%5Cn%20%20%20%20%20%20animation%3A%20fadeInFromNone%203s%20ease-out%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%23slide-sync-bar-anim%3Anot(.paused)%20%7B%5Cn%20%20%20%20%20%20opacity%3A%200.1%3B%5Cn%20%20%20%20%20%20transform%3A%20translateY(-20px)%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%23slide-sync-bar-anim%3Ahover%20%7B%5Cn%20%20%20%20%20%20opacity%3A%201%3B%5Cn%20%20%20%20%20%20transform%3A%20translateY(0px)%3B%5Cn%20%20%20%20%20%20transition%3A%20opacity%200.1s%2C%20transform%200.1s%3B%5Cn%20%20%20%20%20%20animation%3A%20fadeInFromNone%200s%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%5Cn%20%20%20%20%23slide-sync-bar%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20white%3B%5Cn%20%20%20%20%20%20padding%3A%206px%208px%3B%5Cn%20%20%20%20%20%20border%3A%201px%20solid%20rgba(0%2C%200%2C%200%2C%200.1)%3B%5Cn%20%20%20%20%20%20border-radius%3A%200%200%2010px%2010px%3B%5Cn%20%20%20%20%20%20margin-top%3A%20-1px%3B%5Cn%20%20%20%20%20%20display%3A%20flex%3B%5Cn%20%20%20%20%20%20flex-direction%3A%20row%3B%5Cn%20%20%20%20%20%20align-items%3A%20center%3B%5Cn%20%20%20%20%20%20box-shadow%3A%20rgba(0%2C0%2C0%2C0.5)%200px%201px%2012px%20-1px%3B%5Cn%5Cn%20%20%20%20%20%20transition%3A%20opacity%201s%200.5s%2C%20transform%201s%200.5s%3B%5Cn%20%20%20%20%20%20animation%3A%20fadeInFromNone%203s%20ease-out%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%23slide-sync-bar%3Anot(.paused)%20%7B%5Cn%20%20%20%20%20%20opacity%3A%200.1%3B%5Cn%20%20%20%20%20%20transform%3A%20translateY(-25px)%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%23slide-sync-bar-anim%3Ahover%20%23slide-sync-bar%20%7B%5Cn%20%20%20%20%20%20opacity%3A%201%3B%5Cn%20%20%20%20%20%20transform%3A%20translateY(0px)%3B%5Cn%20%20%20%20%20%20transition%3A%20opacity%200.1s%2C%20transform%200.1s%3B%5Cn%20%20%20%20%20%20animation%3A%20fadeInFromNone%200s%3B%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%23slide-sync-logo%20%7B%5Cn%20%20%20%20%20%20margin%3A%200%3B%5Cn%20%20%20%20%20%20margin-left%3A%206px%3B%5Cn%20%20%20%20%20%20font-size%3A%201.2em%3B%5Cn%20%20%20%20%20%20font-family%3A%20%5C%22Google%20Sans%5C%22%2CRoboto%2CRobotoDraft%2CHelvetica%2CArial%2Csans-serif%3B%5Cn%20%20%20%20%20%20cursor%3A%20default%3B%5Cn%20%20%20%20%20%20user-select%3A%20none%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button%20%7B%5Cn%20%20%20%20%20%20margin-left%3A%208px%3B%5Cn%20%20%20%20%20%20border%3A%201px%20solid%20rgba(0%2C%200%2C%200%2C%200.1)%3B%5Cn%20%20%20%20%20%20border-radius%3A%204px%3B%5Cn%20%20%20%20%20%20outline%3A0%3B%5Cn%20%20%20%20%20%20cursor%3A%20pointer%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button.disabled%20%7B%5Cn%20%20%20%20%20%20points-events%3A%20none%3B%5Cn%20%20%20%20%20%20opacity%3A%20.4%3B%5Cn%20%20%20%20%20%20cursor%3A%20default%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button.primary%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20%23fbbc04%3B%5Cn%20%20%20%20%20%20border%3A%200%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button%20p%20%7B%5Cn%20%20%20%20%20%20margin%3A%208px%3B%5Cn%20%20%20%20%20%20user-select%3A%20none%3B%5Cn%20%20%20%20%20%20font-weight%3A500%3B%5Cn%20%20%20%20%20%20font-family%3A%20%5C%22Google%20Sans%5C%22%2CRoboto%2CRobotoDraft%2CHelvetica%2CArial%2Csans-serif%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button.primary%3Ahover%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20%23fbc117%3B%5Cn%20%20%20%20%20%20border%3A%200%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button.primary%3Aactive%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20%23fcd154%3B%5Cn%20%20%20%20%20%20border%3A%200%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button%3Ahover%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20%23fffdf6%3B%5Cn%20%20%20%20%20%20border%3A%201px%20solid%20%23feedbc%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.slide-sync-button%3Aactive%20%7B%5Cn%20%20%20%20%20%20background-color%3A%20%23fff7e1%3B%5Cn%20%20%20%20%20%20border%3A%201px%20solid%20%23fee8ac%3B%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%23slide-sync-message%20%7B%5Cn%20%20%20%20%20%20margin-left%3A%2012px%3B%5Cn%20%20%20%20%20%20margin-right%3A%206px%3B%5Cn%20%20%20%20%20%20margin-top%3A%200%3B%5Cn%20%20%20%20%20%20margin-bottom%3A%200%3B%5Cn%20%20%20%20%20%20cursor%3A%20default%3B%5Cn%20%20%20%20%20%20user-select%3A%20none%3B%5Cn%20%20%20%20%7D%5Cn%20%20%22)%3B%0A%7D%0A%0Afunction%20createTooltip(el%2C%20message)%20%7B%0A%20%20el.setAttribute('data-tooltip'%2C%20message)%3B%0A%7D%0A%0Afunction%20setButtonsVisible(stopPresent%2C%20stopView%2C%20present%2C%20view)%20%7B%0A%20%20var%20slideBase%20%3D%20getUI()%20%7C%7C%20getUIInPresentation()%3B%0A%20%20slideBase.querySelector('%23slide-sync-button-stopPresenting').style.display%20%3D%20stopPresent%20%3F%20'block'%20%3A%20'none'%3B%0A%20%20slideBase.querySelector('%23slide-sync-button-stopViewing').style.display%20%3D%20stopView%20%3F%20'block'%20%3A%20'none'%3B%0A%20%20slideBase.querySelector('%23slide-sync-button-present').style.display%20%3D%20present%20%3F%20'block'%20%3A%20'none'%3B%0A%20%20slideBase.querySelector('%23slide-sync-button-view').style.display%20%3D%20view%20%3F%20'block'%20%3A%20'none'%3B%0A%7D%0A%0Afunction%20setUIStateNone()%20%7B%0A%20%20setStatus()%3B%0A%20%20setButtonsVisible(false%2C%20false%2C%20true%2C%20true)%3B%0A%7D%0A%0Afunction%20setUIStateViewing()%20%7B%0A%20%20setButtonsVisible(false%2C%20true%2C%20false%2C%20false)%3B%0A%7D%0A%0Afunction%20setUIStatePresenting()%20%7B%0A%20%20setButtonsVisible(true%2C%20false%2C%20false%2C%20false)%3B%0A%7D%0A%0Afunction%20setUIStateNotAPresentation()%20%7B%0A%20%20setStatus(%22Only%20works%20on%20Google%20Slides%22)%3B%0A%20%20setButtonsVisible(false%2C%20false%2C%20false%2C%20false)%3B%0A%7D%0A%0Afunction%20addClass(el%2C%20className)%20%7B%0A%20%20if%20(!el.classList.contains(className))%20%7B%0A%20%20%20%20el.classList.add(className)%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20removeClass(el%2C%20className)%20%7B%0A%20%20if%20(el.classList.contains(className))%20%7B%0A%20%20%20%20el.classList.remove(className)%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20setPaused(isPaused)%20%7B%0A%20%20var%20slideBase%20%3D%20getUI()%20%7C%7C%20getUIInPresentation()%3B%0A%20%20if%20(!slideBase)%20return%3B%0A%20%20var%20slideBarOuter%20%3D%20slideBase.querySelector('%23slide-sync-bar-anim')%3B%0A%20%20var%20slideBarInner%20%3D%20slideBase.querySelector('%23slide-sync-bar')%3B%0A%20%20var%20pausedClassName%20%3D%20'paused'%3B%0A%0A%20%20if%20(isPaused)%20%7B%0A%20%20%20%20addClass(slideBarOuter%2C%20pausedClassName)%3B%0A%20%20%20%20addClass(slideBarInner%2C%20pausedClassName)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20removeClass(slideBarOuter%2C%20pausedClassName)%3B%0A%20%20%20%20removeClass(slideBarInner%2C%20pausedClassName)%3B%0A%20%20%7D%0A%7D%0A%0Afunction%20setStatus(statusMessage)%20%7B%0A%20%20var%20slideBase%20%3D%20getUI()%20%7C%7C%20getUIInPresentation()%3B%0A%20%20if%20(!slideBase)%20return%3B%0A%20%20var%20text%20%3D%20slideBase.querySelector('%23slide-sync-message')%3B%0A%0A%20%20if%20(!statusMessage)%20%7B%0A%20%20%20%20if%20(text.style.display%20!%3D%20'none')%20%7B%0A%20%20%20%20%20%20text.style.display%20%3D%20'none'%3B%0A%20%20%20%20%20%20setPaused(false)%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20text.style.display%20%3D%20'block'%3B%0A%0A%20%20%20%20if%20(text.textContent%20!%3D%20statusMessage)%20%7B%0A%20%20%20%20%20%20text.textContent%20%3D%20statusMessage%3B%0A%20%20%20%20%20%20setPaused(true)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Afunction%20createUI()%20%7B%0A%20%20removeExistingUI()%3B%0A%20%20var%20div%20%3D%20window.document.createElement('div')%3B%0A%20%20div.id%20%3D%20%22slide-sync-base%22%3B%0A%20%20div.innerHTML%20%3D%20%22%5Cn%3Cdiv%20id%3D%5C%22slide-sync-container%5C%22%3E%5Cn%20%20%3Cdiv%20id%3D%5C%22slide-sync-bar-anim%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20id%3D%5C%22slide-sync-bar%5C%22%3E%5Cn%20%20%20%20%20%20%3Cp%20id%3D%5C%22slide-sync-logo%5C%22%3ESlideSync%3C%2Fp%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id%3D%5C%22slide-sync-button-present%5C%22%20class%3D%5C%22slide-sync-button%5C%22%3E%3Cp%3EHost%3C%2Fp%3E%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id%3D%5C%22slide-sync-button-view%5C%22%20class%3D%5C%22slide-sync-button%20primary%5C%22%3E%3Cp%3EWatch%3C%2Fp%3E%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id%3D%5C%22slide-sync-button-stopPresenting%5C%22%20class%3D%5C%22slide-sync-button%20primary%5C%22%3E%3Cp%3EStop%20Hosting%3C%2Fp%3E%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id%3D%5C%22slide-sync-button-stopViewing%5C%22%20class%3D%5C%22slide-sync-button%20primary%5C%22%3E%3Cp%3EStop%20Watching%3C%2Fp%3E%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%3Cp%20id%3D%5C%22slide-sync-message%5C%22%3EMessage%3C%2Fp%3E%5Cn%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%3C%2Fdiv%3E%5Cn%3C%2Fdiv%3E%5Cn%20%20%22%3B%0A%20%20ensureCss(div)%3B%0A%20%20window.document.body.append(div)%3B%0A%20%20var%20presentButton%20%3D%20div.querySelector('%23slide-sync-button-present')%3B%0A%20%20presentButton.addEventListener('click'%2C%20function%20()%20%7B%0A%20%20%20%20if%20(!hasEditAccess())%20return%3B%0A%20%20%20%20startPresent()%3B%0A%20%20%20%20setUIStatePresenting()%3B%0A%20%20%20%20startPresentationMode()%3B%0A%20%20%7D)%3B%0A%0A%20%20if%20(!hasEditAccess())%20%7B%0A%20%20%20%20presentButton.classList.add(%22disabled%22)%3B%0A%20%20%20%20createTooltip(presentButton%2C%20'Need%20edit%20permission%20to%20Host')%3B%0A%20%20%7D%0A%0A%20%20var%20viewButton%20%3D%20div.querySelector('%23slide-sync-button-view')%3B%0A%20%20viewButton.addEventListener('click'%2C%20function%20()%20%7B%0A%20%20%20%20startView()%3B%0A%20%20%20%20setUIStateViewing()%3B%0A%20%20%20%20startPresentationMode()%3B%0A%20%20%7D)%3B%0A%20%20var%20presentStopButton%20%3D%20div.querySelector('%23slide-sync-button-stopPresenting')%3B%0A%20%20presentStopButton.addEventListener('click'%2C%20function%20()%20%7B%0A%20%20%20%20stopPresent()%3B%0A%20%20%20%20setUIStateNone()%3B%0A%20%20%7D)%3B%0A%20%20var%20viewStopButton%20%3D%20div.querySelector('%23slide-sync-button-stopViewing')%3B%0A%20%20viewStopButton.addEventListener('click'%2C%20function%20()%20%7B%0A%20%20%20%20stopView()%3B%0A%20%20%20%20setUIStateNone()%3B%0A%20%20%7D)%3B%0A%20%20setStatus()%3B%0A%20%20if%20(!isGoogleSlidesPresentation())%20setUIStateNotAPresentation()%3Belse%20if%20(isViewing())%20setUIStateViewing()%3Belse%20if%20(isPresenting())%20setUIStatePresenting()%3Belse%20setUIStateNone()%3B%0A%7D%0A%0AremoveExistingUI()%3B%20%2F%2F%20check%20if%20presentation%20mode%0A%0Aif%20(window.slideSyncInterval)%20%7B%0A%20%20clearInterval(window.slideSyncInterval)%3B%0A%7D%0A%0Avar%20slideSyncNoUICount%20%3D%200%3B%0A%0Avar%20updateUI%20%3D%20function%20updateUI()%20%7B%0A%20%20%2F%2F%20there%20is%20a%20period%20while%20transitioning%20from%20full%20screen%20-%3E%20not%20full%20screen%20that%20the%20%0A%20%20%2F%2F%20browser%20context%20is%20null%2C%20so%20no%20UI%20is%20found.%20Wait%20a%20bit%20so%20it%20has%20time%20to%20un-full-screen%0A%20%20%2F%2F%20before%20creating%20new%20UI%0A%20%20%2F%2F%20It%20takes%20even%20longer%20to%20move%20from%20not%20full%20screen%20to%20full%20screen%2C%20so%20have%20a%20super%20high%20count%0A%20%20if%20(!getUI())%20%7B%0A%20%20%20%20slideSyncNoUICount%2B%2B%3B%0A%0A%20%20%20%20if%20(slideSyncNoUICount%20%3E%20(getPresentation()%20%3F%204%20%3A%202))%20%7B%0A%20%20%20%20%20%20createUI()%3B%0A%20%20%20%20%20%20slideSyncNoUICount%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20var%20presentation%20%3D%20getPresentation()%3B%0A%20%20var%20inPresentation%20%3D%20getUIInPresentation()%3B%0A%0A%20%20if%20(getUI())%20%7B%0A%20%20%20%20%2F%2F%20presentation.body%20is%20null%20for%20one%20frame%0A%20%20%20%20if%20(presentation%20%26%26%20!inPresentation%20%26%26%20presentation.body)%20%7B%0A%20%20%20%20%20%20presentation.body.appendChild(getUI())%3B%0A%20%20%20%20%7D%20else%20if%20(!presentation%20%26%26%20inPresentation)%20%7B%0A%20%20%20%20%20%20window.document.body.appendChild(getUI())%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0A%0AcreateUI()%3B%0AupdateUI()%3B%0Awindow.slideSyncInterval%20%3D%20setInterval(updateUI%2C%20500)%3B%7D)()%3B"